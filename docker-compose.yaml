services:
  govee-h5075-prom-exporter:
    build: .
    container_name: govee-h5075-prom-exporter
    network_mode: "host"  # Required for Bluetooth access
    cap_add:
      - NET_ADMIN
      - NET_RAW
    devices:
      - "/dev/bus/usb:/dev/bus/usb"
    environment:
      - PORT=8080
      - SCAN_INTERVAL=15s
      - SCAN_DURATION=15s
      - REFRESH_INTERVAL=30s
      - STALE_THRESHOLD=5m
      - DBUS_SYSTEM_BUS_ADDRESS=unix:path=/run/dbus/system_bus_socket
      # Dashboard warning thresholds (optional)
      - TEMPERATURE_MIN=-20
      - TEMPERATURE_MAX=40
      - TEMPERATURE_LOW_THRESHOLD=0
      - TEMPERATURE_HIGH_THRESHOLD=35
      - HUMIDITY_LOW_THRESHOLD=30
      - HUMIDITY_HIGH_THRESHOLD=70
      - BATTERY_LOW_THRESHOLD=5
    volumes:
      - /run/dbus/system_bus_socket:/run/dbus/system_bus_socket # Mount DBus socket
      - ./config.yaml:/app/config.yaml:ro # Mount config.yaml with device configuration
    restart: unless-stopped